ylab("Ratio")
ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p <- ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p$guides
p$layers
p$data
p$theme
p <- ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
#axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p <- ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p$scales
p <- ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
#panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
#panel.grid.major = element_blank(),
panel.grid.minor = element_line(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12)
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12)
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p <- ggplot(ggd1, horiz = T, theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12)
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
#panel.grid.major = element_blank(),
panel.grid.minor = element_line(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
#panel.grid.major = element_blank(),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
#scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
ggplot(p)
ggplotly(p)
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
#panel.grid.major = element_blank(),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_x_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
#panel.grid.major = element_blank(),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_y_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
ggplotly(p)
ggd1 <- as.ggdend(dend)
ggd1$labels
ggd1$labels$y+0.1
ggd1$labels$y <- ggd1$labels$y+0.1
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_y_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
ggd1 <- as.ggdend(dend)
ggd1$labels$y2 <- ggd1$labels$y
ggd1$labels$y <- ggd1$labels$y+0.001
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_y_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
ggd1$labels$y <- ggd1$labels$y2-0.001
p
ggd1$labels$y <- ggd1$labels$y2-0.01
p
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_y_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
ggd1$labels$y <- ggd1$labels$y2-0.001
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_y_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
ggd1$labels$y <- ggd1$labels$y2-0.01
p <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_y_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
p
ggplot(p)
ggplotly(p)
ggd1 <- as.ggdend(dend)
ggd1$labels$y <- ggd1$labels$y-0.005
p_dend <- ggplot(ggd1, horiz = T,  theme = NULL)  +
theme(
axis.line = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank(),axis.ticks.x = element_line(),
axis.text.y = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.x = element_text(size = 12),
panel.grid.minor = element_line(color = "gray"),
panel.border = element_blank(),
panel.background = element_blank(),
legend.position = "none"
) +
scale_y_continuous(sec.axis = sec_axis(~ . * nucs, name = "Mutations")) +
ylab("Ratio")
ggplotly(p_dend)
p_dend
p_dend
ggplotly(p_dend)
ggplotly(p_dend) %>% layout(
xaxis = ax,
xaxis2 = ax2)
gp <- ggplotly(p_dend)
gp$x$layout
ax <- list(
side = "bottom",
showticklabels = TRUE,
tickmode = "array")
ax2 <- list(
overlaying = "x",
side = "top",
showticklabels = TRUE,
tickmode = "array",
tickfont = list(size = 11)) # I added this line
ggplotly(p_dend) %>%
add_markers(data = NULL, inherit = TRUE, xaxis = "x2") %>% # new line
layout(
xaxis = ax,
xaxis2 = ax2)
ggplotly(p_dend) %>%
add_markers(data = NULL, inherit = TRUE, xaxis = "x2")
ggplotly(p_dend) %>%
add_markers(data = NULL, inherit = TRUE, yaxis = "y2")
ggplotly(p_dend) %>%
add_markers(data = NULL, inherit = TRUE, xaxis = "x2")
ggplotly(p_dend) %>%layout(
xaxis = ax,
xaxis2 = ax2)
ggplotly(p_dend) %>%
add_markers(data = NULL, inherit = F, xaxis = "x2") %>% # new line
layout(
xaxis = ax,
xaxis2 = ax2)
ggplotly(p_dend) %>%
add_markers(data = NULL, inherit = T, xaxis = "x2") %>% # new line
layout(
xaxis = ax,
xaxis2 = ax2)
pg <- ggplotly(p_dend)
pg$x$layout$xaxis2 <- pg$x$layout$xaxis
pg %>%
layout(
xaxis = ax,
xaxis2 = ax2)
pg$x$layout$xaxis2
ax2 <- list(
overlaying = "x",
side = "top",
showticklabels = TRUE,
range = limits,
tickmode = "array",
tickvals = breaks,
ticktext = labels_dup,
tickfont = list(size = 11))
p_dend$labels
p_dend
p_dend$data
p_dend$layers
p_dend$mapping
p_dend$coordinates
p1 <- cowplot::plot_grid(plotlist = p_list,
nrow = 4,
align = "v")
p1
ggplotly(p1)
bookdown::preview_chapter("08-G8.rmd")
bookdown::preview_chapter("08-G8.rmd")
source("functions.R", local = TRUE)
seq_align2(v_calls, allele_db, vgerms, chain, mat, g_group)
source("functions.R", local = TRUE)
seq_align2(v_calls, allele_db, vgerms, chain, mat, g_group)
source("functions.R", local = TRUE)
seq_align2(v_calls, allele_db, vgerms, chain, mat, g_group)
source("functions.R", local = TRUE)
seq_align2(v_calls, allele_db, vgerms, chain, mat, g_group)
bookdown::preview_chapter("08-G8.rmd")
seq_align(v_calls, allele_db, vgerms, chain, mat, g_group)
bookdown::preview_chapter("08-G8.rmd")
seq_align(v_calls, allele_db, vgerms, chain, mat, g_group)
bookdown::preview_chapter("08-G8.rmd")
seq_align2(v_calls, allele_db, vgerms, chain, mat, g_group)
seq_align2(v_calls, allele_db, vgerms, chain, mat, g_group)
bookdown::preview_chapter("08-G8.rmd")
bookdown::preview_chapter("08-G8.rmd")
bookdown::preview_chapter("08-G8.rmd")
bookdown::preview_chapter("08-G8.rmd")
bookdown::preview_chapter("08-G8.rmd")
files2 <- list.files("../reference_book2/",".rmd")
f= files2[1]
lines <- readLines(f)
id <- grep("v_calls <- unique(", lines)
)
id <- grep("v_calls <- unique", lines)
id
lines[54]
lines[55]
lines[(id-1):(id+2)]
lines2 <- lines[1:(id-2)]
lines2
lines3 <- lines[(id-1):length(lines)]
lines3
lines[(id-1):(id+2)]
lines5 <- lines[(id+3):length(lines)]
lines3 <- lines[(id-1):(id+2)]
lines3
lines2 <- lines[1:(id-2)]
lines3 <- c("```{r}", "v_calls <- unique(data[grepl(g_group,v_gene),v_call])", "seq_align(v_calls, allele_db, vgerms, chain, mat, g_group)","```")
lines4 <- lines[(id-1):(id+2)]
lines5 <- lines[(id+3):length(lines)]
lines4[3]
lines4[3] <- gsub("seq_align","seq_align2", lines4[3])
lines4
files2
files2 <- files2[-8]
files2
for(f in files2){
lines <- readLines(f)
id <- grep("v_calls <- unique", lines)
if(length(id)!=0){
lines2 <- lines[1:(id-2)]
lines3 <- c("```{r}", "v_calls <- unique(data[grepl(g_group,v_gene),v_call])", "seq_align(v_calls, allele_db, vgerms, chain, mat, g_group)","```")
lines4 <- lines[(id-1):(id+2)]
lines4[3] <- gsub("seq_align","seq_align2", lines4[3])
lines5 <- lines[(id+3):length(lines)]
lines <- c(lines2, lines3, lines4, lines5)
writeLines(lines, f)
}
}
